(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{470:function(t,e,a){t.exports=a.p+"assets/img/computed-1.63094091.jpg"},471:function(t,e,a){t.exports=a.p+"assets/img/computed-2.a6cf0338.png"},566:function(t,e,a){"use strict";a.r(e);var r=a(56),s=Object(r.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"computed-计算属性-原理"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#computed-计算属性-原理"}},[t._v("#")]),t._v(" Computed（计算属性）原理")]),t._v(" "),r("h2",{attrs:{id:"初始化过程"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#初始化过程"}},[t._v("#")]),t._v(" 初始化过程：")]),t._v(" "),r("div",{staticClass:"language-bash extra-class"},[r("pre",{pre:!0,attrs:{class:"language-bash"}},[r("code",[t._v("_init "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" initData "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" initComputed "),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),r("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" vm."),r("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$mount")]),t._v("\n")])])]),r("h3",{attrs:{id:"渲染过程关键调用关系图"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#渲染过程关键调用关系图"}},[t._v("#")]),t._v(" 渲染过程关键调用关系图：")]),t._v(" "),r("h4",{attrs:{id:"_1-渲染主流程"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1-渲染主流程"}},[t._v("#")]),t._v(" 1.渲染主流程")]),t._v(" "),r("p",[r("img",{attrs:{src:a(470),alt:"渲染主流程"}})]),t._v(" "),r("h4",{attrs:{id:"_2-计算属性watcher中逻辑"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2-计算属性watcher中逻辑"}},[t._v("#")]),t._v(" 2.计算属性watcher中逻辑")]),t._v(" "),r("p",[r("img",{attrs:{src:a(471),alt:"计算属性watcher逻辑"}})]),t._v(" "),r("h4",{attrs:{id:"初始化涉及到的函数及其作用"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#初始化涉及到的函数及其作用"}},[t._v("#")]),t._v(" 初始化涉及到的函数及其作用：")]),t._v(" "),r("ul",[r("li",[t._v("initComputed： 为每个computed属性创建一个对应的watcher——"),r("code",[t._v("计算属性watcher")])]),t._v(" "),r("li",[t._v("defineComputed：将computed属性挂载到Vue实例上（vm），并实现响应式，属性getter由createComputedGetter创建")]),t._v(" "),r("li",[t._v("createComputedGetter：创建并返回computed属性的匿名getter函数")]),t._v(" "),r("li",[t._v("匿名getter函数：页面渲染过程，render函数被调用，_s(computed属性)调用到此函数。\n"),r("ul",[r("li",[t._v("可以看到为了实现计算属性，Watcher新增了"),r("code",[t._v("dirty")]),t._v("、"),r("code",[t._v("evaluate")]),t._v("、"),r("code",[t._v("depend")]),t._v("等成员属性。")])])])]),t._v(" "),r("h3",{attrs:{id:"watcher部分"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#watcher部分"}},[t._v("#")]),t._v(" watcher部分")]),t._v(" "),r("ul",[r("li",[t._v("dirty：\n"),r("ul",[r("li",[t._v("Observer构造函数中初始化为"),r("code",[t._v("true")]),t._v("——需要重新计算computed属性；")]),t._v(" "),r("li",[r("code",[t._v("false")]),t._v('——不需要重新计算，即"'),r("strong",[t._v("缓存")]),t._v('"。（场景：一个组件内的模板中，多处插值使用该计算属性，gettr中不再重复计算）')])])]),t._v(" "),r("li",[t._v("evaluate：\n"),r("ul",[r("li",[t._v("顾名思义——表达式求值，和dirty搭配使用，需要重新计算计算属性的时候调用此方法；")]),t._v(" "),r("li",[t._v("调用"),r("code",[t._v("observer.get")]),t._v("，重置dirty（下次getter被调用就无需计算）")])])]),t._v(" "),r("li",[t._v("depend\n"),r("ul",[r("li",[r("code",[t._v("计算属性watcher")]),t._v("依赖的属性的dep（本例中的：firstName的dep、lastName的dep），收集依赖")])])])]),t._v(" "),r("p",[t._v("参考：https://juejin.cn/post/6974293549135167495")])])}),[],!1,null,null,null);e.default=s.exports}}]);