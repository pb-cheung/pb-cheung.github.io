(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{350:function(t,s,a){t.exports=a.p+"assets/img/http-cache.03707252.png"},417:function(t,s,a){t.exports=a.p+"assets/img/browser-parser-painting.db8f7ae4.png"},418:function(t,s,a){t.exports=a.p+"assets/img/standard-ttfb.f5c20f99.png"},419:function(t,s,a){t.exports=a.p+"assets/img/PerformanceNavigationTiming.6ad1590d.png"},529:function(t,s,a){"use strict";a.r(s);var n=a(56),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"性能优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#性能优化"}},[t._v("#")]),t._v(" 性能优化")]),t._v(" "),n("h2",{attrs:{id:"常见指标"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常见指标"}},[t._v("#")]),t._v(" 常见指标")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://web.dev/metrics/",target:"_blank",rel:"noopener noreferrer"}},[t._v("指标|web.dev"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"一、fp-首次绘制-first-paint"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、fp-首次绘制-first-paint"}},[t._v("#")]),t._v(" 一、FP:首次绘制（First Paint）")]),t._v(" "),n("p",[t._v("浏览器从请求内容到首次像屏幕绘制像素点（下图的Painting）的过程的时间。可以理解为时"),n("strong",[t._v("白屏")]),t._v("时间。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(417),alt:"浏览器渲染过程"}})]),t._v(" "),n("p",[t._v("获取方法：")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 此方法如果执行时机过早可能会报错")]),t._v("\nwindow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("performance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntriesByType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'paint'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("startTime\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更推荐使用 Promise 封装获取")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" observerWithPromise "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("PerformanceObserverEntryList"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PerformanceObserver")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolve"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entryTypes")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'paint'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \nobserverWithPromise\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entryList")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" entryList"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntries")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entry")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'first-paint'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entry")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("startTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"二、fcp-首次内容绘制-first-contentful-paint"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、fcp-首次内容绘制-first-contentful-paint"}},[t._v("#")]),t._v(" 二、FCP:首次内容绘制（First Contentful Paint）")]),t._v(" "),n("p",[t._v("浏览器渲染出第一个内容的时间，内容可以是文本、图片等。")]),t._v(" "),n("p",[t._v("FCP >= FP")]),t._v(" "),n("p",[t._v("获取方法：")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 此方法如果执行过早可能会报错")]),t._v("\nwindow"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("performance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntriesByType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'paint'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("startTime\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更推荐使用 Promise 封装获取")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" observerWithPromise "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("PerformanceObserverEntryList"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PerformanceObserver")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolve"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entryTypes")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'paint'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \nobserverWithPromise\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entryList")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" entryList"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntries")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("filter")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entry")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'first-contentful-paint'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entry")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("entry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("startTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[n("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/PerformancePaintTiming",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN | PerformancePaintTiming"),n("OutboundLink")],1)]),t._v(" "),n("h3",{attrs:{id:"三、fmp-首次有意义渲染-first-meaningful-paint"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、fmp-首次有意义渲染-first-meaningful-paint"}},[t._v("#")]),t._v(" 三、FMP:首次有意义渲染（First Meaningful Paint）")]),t._v(" "),n("p",[t._v("这个概念没有标准化定义，不同业务的关键元素不同，例如博客网站关键元素是文字，视频网站关键元素是播放器。不能使用API直接获取，现在被LCP替代了。")]),t._v(" "),n("h3",{attrs:{id:"四、lcp-最大内容绘制-largest-contentful-paint"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#四、lcp-最大内容绘制-largest-contentful-paint"}},[t._v("#")]),t._v(" 四、LCP:最大内容绘制（Largest Contentful Paint）")]),t._v(" "),n("p",[t._v("可视区域内（浏览器窗口）最大的可见元素出现在屏幕上的时间，"),n("strong",[t._v("核心指标")]),t._v("。")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" observerWithPromise "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("PerformanceObserverEntryList"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PerformanceObserver")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolve"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entryTypes")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'largest-contentful-paint'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  observerWithPromise\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entryList")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" entries "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" entryList"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntries")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" lastEntry "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" entries"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("entries"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("lastEntry"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("startTime"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"五、tti-用户可交互时间-time-to-interactive"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#五、tti-用户可交互时间-time-to-interactive"}},[t._v("#")]),t._v(" 五、TTI:用户可交互时间（Time to Interactive）")]),t._v(" "),n("p",[t._v("用户可以与应用进行交互的时间，一般指"),n("code",[t._v("domready")]),t._v("事件的时间，我们通常会绑定这个事件开始写业务逻辑。")]),t._v(" "),n("p",[t._v("TTI 的测算建议使用 Lighthouse。")]),t._v(" "),n("h3",{attrs:{id:"六、ttfb-网络请求耗时-time-to-first-byte"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#六、ttfb-网络请求耗时-time-to-first-byte"}},[t._v("#")]),t._v(" 六、TTFB:网络请求耗时（Time To First Byte）")]),t._v(" "),n("p",[t._v("请求发出开始（输入地址敲下回车），到收到响应的第一个字节的时间。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(418),alt:"网络请求阶段及其相关时间损耗的图示"}})]),t._v(" "),n("p",[t._v("TTFB 测量startTime和responseStart之间的时间损耗。")]),t._v(" "),n("p",[t._v("获取方式：")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[t._v("window"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("performance"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("timing"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" observerWithPromise "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("PerformanceObserverEntryList"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("PerformanceObserver")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resolve"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("observe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entryTypes")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'navigation'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  observerWithPromise\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("entryList")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("pageNav"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" entryList"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntriesByType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'navigation'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("pageNav"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h2",{attrs:{id:"timing-api"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#timing-api"}},[t._v("#")]),t._v(' "timing"API')]),t._v(" "),n("p",[n("img",{attrs:{src:a(419),alt:""}})]),t._v(" "),n("p",[t._v("https://w3c.github.io/navigation-timing/#processing-model")]),t._v(" "),n("h3",{attrs:{id:"各个属性时间含义"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#各个属性时间含义"}},[t._v("#")]),t._v(" 各个属性时间含义：")]),t._v(" "),n("ul",[n("li",[t._v("startTime：开始时间，0")]),t._v(" "),n("li",[t._v("unloadEventStart：前一个页面卸载开始")]),t._v(" "),n("li",[t._v("unloadEventEnd：前一个页面卸载完成")]),t._v(" "),n("li",[t._v("redirectStart：重定向开始")]),t._v(" "),n("li",[t._v("redirectEnd：重定向完成，没有发生则为0")]),t._v(" "),n("li",[t._v("fetchStart：浏览器准备好了使用HTTP请求来获取文档的时间点")]),t._v(" "),n("li",[t._v("domianLookupStart：域名查询开始时间。如果使用了持续连接或者缓存，取值等于fetchStart")]),t._v(" "),n("li",[t._v("domianLookupStart：域名查询完成时间戳")]),t._v(" "),n("li",[t._v("connectStart：开始建立连接，如果使用了持久链接，值等于fetchStart")]),t._v(" "),n("li",[t._v("SecureConnectStart：开始建立安全连接（https）")]),t._v(" "),n("li",[t._v("connectEnd：连接建立完成")]),t._v(" "),n("li",[t._v("requestStart：（向服务器）发送请求时的时间戳")]),t._v(" "),n("li",[t._v("responseStart：浏览器从服务器、缓存或者本地资源接收到响应的第一个字节之时的 Unix毫秒时间戳")]),t._v(" "),n("li",[t._v("responseEnd：接受响应的最后一个字节的时间戳")]),t._v(" "),n("li",[t._v("domInterActive：HTML解析完成，DOM树构建完成的时间戳")]),t._v(" "),n("li",[t._v("domContentLoadedEventStart："),n("code",[t._v("domContentLoaded")]),t._v("发出之前，开始解析内联脚本\n"),n("blockquote",[n("p",[t._v("DOMContentLoaded 事件的触发时机早于其他资源（如图片、样式表和外部脚本）的加载完成，因此它通常被用于执行需要操作 DOM 元素的 JavaScript 代码。通过将代码放置在 DOMContentLoaded 事件的监听器中，可以确保代码只在 DOM 准备就绪后执行，避免了访问尚未加载的元素而导致错误。")])])]),t._v(" "),n("li",[t._v("domContentLoadedEventEnd：解析内联脚本结束")]),t._v(" "),n("li",[t._v("domComplete："),n("code",[t._v("Document.readyState")]),t._v("变为"),n("code",[t._v("complete")]),t._v("的时间戳")]),t._v(" "),n("li",[t._v("loadEventStart："),n("code",[t._v("onload")]),t._v("事件触发的时间点")]),t._v(" "),n("li",[t._v("loadEventEnd：所有事件都执行完")])]),t._v(" "),n("h2",{attrs:{id:"优化"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#优化"}},[t._v("#")]),t._v(" 优化")]),t._v(" "),n("p",[t._v("分清维度（线索），有的放矢")]),t._v(" "),n("p",[t._v("页面打开全流程，可以像上一节"),n("code",[t._v("timing API")]),t._v("中的属性那样，分为不同阶段维度进行优化。")]),t._v(" "),n("h3",{attrs:{id:"一、i-o-network-维度"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#一、i-o-network-维度"}},[t._v("#")]),t._v(" 一、I/O（network）维度")]),t._v(" "),n("h4",{attrs:{id:"_1-httpcache阶段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-httpcache阶段"}},[t._v("#")]),t._v(" 1.HttpCache阶段")]),t._v(" "),n("ul",[n("li",[t._v("主资源——html页面")])]),t._v(" "),n("p",[t._v("使用"),n("code",[t._v("Cache-Control: no-cache")]),t._v("，每次都会向服务器发送请求检查缓存是否有效，有效返回304去使用缓存，使其始终为最新。")]),t._v(" "),n("p",[t._v("一般不能使用缓存破坏（caching bust）来更新，因为URL不变。")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[t._v(">缓存破坏就是通过创建新文件且修改文件名，且文件名包含hash、版本号或者添加query时间戳参数等方法，建立新的缓存文件不再使用旧的文件。\n")])])]),n("ul",[n("li",[t._v("子资源——js、css、图片等")])]),t._v(" "),n("p",[t._v("使用协商缓存("),n("code",[t._v("max-age/ETag")]),t._v(")+缓存破坏。")]),t._v(" "),n("p",[t._v("脚本、字体、图片缓存一般缓存在内存（"),n("code",[t._v("memory cache")]),t._v("）中，非脚本的例如css文件会缓存在磁盘（"),n("code",[t._v("disk cache")]),t._v("）中。")]),t._v(" "),n("p",[n("img",{attrs:{src:a(350),alt:"http-cache"}})]),t._v(" "),n("p",[n("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching#%E5%B8%B8%E8%A7%81%E7%9A%84%E7%BC%93%E5%AD%98%E6%A8%A1%E5%BC%8F",target:"_blank",rel:"noopener noreferrer"}},[t._v("常见的缓存模式|MDN"),n("OutboundLink")],1)]),t._v(" "),n("h4",{attrs:{id:"_2-dns阶段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-dns阶段"}},[t._v("#")]),t._v(" 2.DNS阶段")]),t._v(" "),n("p",[t._v("应用用到的域名收敛，能少就少，一般两个：业务域名+CDN域名。")]),t._v(" "),n("h4",{attrs:{id:"_3-tcp阶段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-tcp阶段"}},[t._v("#")]),t._v(" 3.TCP阶段")]),t._v(" "),n("h5",{attrs:{id:"keep-alive模式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#keep-alive模式"}},[t._v("#")]),t._v(" "),n("code",[t._v("Keep-Alive")]),t._v("模式")]),t._v(" "),n("blockquote",[n("p",[t._v("非KeepAlive模式时，每个请求/应答客户和服务器都要新建一个连接，完成 之后立即断开连接（HTTP协议为无连接的协议）；当使用Keep-Alive模式（又称持久连接、连接重用）时，Keep-Alive功能使客户端到服 务器端的连接持续有效，当出现对服务器的后继请求时，Keep-Alive功能避免了建立或者重新建立连接。")])]),t._v(" "),n("p",[n("strong",[t._v("如何开启使用")])]),t._v(" "),n("p",[t._v("http1.0中默认关闭。\nhttp1.1中默认启用， 默认情况下所在HTTP1.1中所有连接都被保持，除非在请求头或响应头中指明要关闭："),n("code",[t._v("Connection: Close")]),t._v("。")]),t._v(" "),n("p",[t._v("a. 浏览器发起请求时header中添加"),n("code",[t._v("Connection: Keep-Alive")])]),t._v(" "),n("p",[t._v("b. 服务端收到请求看到包含次字段，response中添加同样的字段，像这样：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("HTTP/1.1 200 OK\nConnection: Keep-Alive\nContent-Encoding: gzip\nContent-Type: text/html; charset=utf-8\nDate: Thu, 11 Aug 2016 15:23:13 GMT\nKeep-Alive: timeout=5, max=1000\nLast-Modified: Mon, 25 Jul 2016 04:32:39 GMT\nServer: Apache\n\n(body)\n\n//解释：`timeout`字段过期时间5秒（对应httpd.conf里的参数是：KeepAliveTimeout），`max`字段是最多一百次请求，强制断掉连接，\n")])])]),n("p",[t._v("c. 这样客户端和服务端就建立了HTTP持久连接，客户端再发请求就可以直接使用这个连接了。")]),t._v(" "),n("h4",{attrs:{id:"_4-req-res阶段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-req-res阶段"}},[t._v("#")]),t._v(" 4.REQ/RES阶段")]),t._v(" "),n("p",[t._v("a. 缩小包体积")]),t._v(" "),n("ul",[n("li",[t._v("压缩。uglify、OptimizeCSSAssetsPlugin")]),t._v(" "),n("li",[t._v("runtime。修改babel配置，babel引入polyfill优化")]),t._v(" "),n("li",[t._v("tree shaking。")]),t._v(" "),n("li",[t._v("图片格式，如何进行分解？webp？（64KB）\nbase64格式，体积增大1/3，不用base64则增加一个HTTP请求")])]),t._v(" "),n("p",[t._v("b. 首屏加载的内容拆解")]),t._v(" "),n("ul",[n("li",[t._v("代码分离。webpack的codeSplitPlugin")]),t._v(" "),n("li",[t._v("懒加载。ES动态加载，Vue动态路由、React动态加载")])]),t._v(" "),n("p",[t._v("c. 代码分离和浏览器并发请求数限制的平衡")]),t._v(" "),n("ul",[n("li",[t._v("代码分离要适度。根据路由和功能拆分，减少首次加载资源的体积的同时防止拆分的过于零碎。")]),t._v(" "),n("li",[t._v("按需加载。动态导入、异步加载。")]),t._v(" "),n("li",[t._v("使用HTTP2/HTTP3。更高级的并发能力，一个TCP连接上的多路复用技术。")])]),t._v(" "),n("h4",{attrs:{id:"_5-processing阶段"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-processing阶段"}},[t._v("#")]),t._v(" 5.Processing阶段")]),t._v(" "),n("p",[t._v("拿到主文档，开始按顺序解析；\n常见的外部依赖有CSS、JavaScript文件，它们的加载执行会阻塞主流程；\n所以常见的优化有：")]),t._v(" "),n("ul",[n("li",[t._v("使用骨架屏，生成页面骨架结构模板放入页面模板，缩短白屏时间（FP）；")]),t._v(" "),n("li",[t._v("js脚本放到"),n("code",[t._v("</body>")]),t._v("body闭合标签的位置，目的是为了防止脚本的加载执行影响主线程解析渲染dom；")]),t._v(" "),n("li",[t._v("数据分析、广告等脚本添加"),n("code",[t._v("async")]),t._v("属性。这类脚本的特点：异步加载、加载完就执行、不关心dom。"),n("code",[t._v('<script src="analytics.js" async><\/script>')]),t._v("；")]),t._v(" "),n("li",[t._v("其他相对独立脚本添加"),n("code",[t._v("defer")]),t._v("属性。特点：异步加载、文档解析完成后执行（"),n("code",[t._v("DOMContentLoaded")]),t._v("之前）。")])]),t._v(" "),n("h4",{attrs:{id:"骨架屏"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#骨架屏"}},[t._v("#")]),t._v(" 骨架屏")]),t._v(" "),n("blockquote",[n("p",[t._v("SPA应用页面模板一般是空白的，需要加载运行框架js代码后将内容挂载到根节点上，这样的机制就会造成白屏时间过长。\n骨架屏优化解决这一问题，在项目打包阶段将骨架内容直接放到html页面模板中（js渲染代码之前），这样在页面渲染阶段在真实页面渲染前不至于显示白屏，显示页面骨架作为过度，\n缩短页面白屏时间，提升用户体验和留存度。")])]),t._v(" "),n("p",[n("code",[t._v("vue-skeleton-webpack-plugin")]),t._v("插件配置：")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue.config.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" SkeletonWebpackPlugin "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue-skeleton-webpack-plugin"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nmodule"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("configureWebpack")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("plugins")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SkeletonWebpackPlugin")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 实例化插件对象")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("webpackConfig")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("entry")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("app")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./src/skeleton.js'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 引入骨架屏入口文件")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("minimize")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// SPA 下是否需要压缩注入 HTML 的 JS 代码")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("quiet")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在服务端渲染时是否需要输出信息到控制台")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("router")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("mode")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hash'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 路由模式")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("routes")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 不同页面可以配置不同骨架屏")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 对应路径所需要的骨架屏组件id，id的定义在入口文件内")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("^\\/home(?:\\/)?")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("i")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("skeletonId")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'homeSkeleton'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("path")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("^\\/detail(?:\\/)?")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-flags"}},[t._v("i")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("skeletonId")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'detailSkeleton'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n          "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("        \n      "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// skeleton.js")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Vue "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vue"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 引入对应的骨架屏页面")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" homeSkeleton "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./views/homeSkeleton"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" detailSkeleton "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./views/detailSkeleton"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("components")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        homeSkeleton"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        detailSkeleton"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("template")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('\n    <div>\n      <homeSkeleton id="homeSkeleton" style="display:none;" />\n      <detailSkeleton id="detailSkeleton" style="display:none;" />\n    </div>\n  ')]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h3",{attrs:{id:"二、渲染维度"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#二、渲染维度"}},[t._v("#")]),t._v(" 二、渲染维度")]),t._v(" "),n("p",[t._v("原则：尽量少的触发浏览器的回流（reflow）和重绘（repaint）")]),t._v(" "),n("p",[n("RouterLink",{attrs:{to:"/interview/reflow-repaint.html"}},[t._v("浏览器回流和重绘")])],1),t._v(" "),n("h4",{attrs:{id:"_1-避免回流和重绘"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-避免回流和重绘"}},[t._v("#")]),t._v(" 1.避免回流和重绘")]),t._v(" "),n("p",[t._v("避免措施：")]),t._v(" "),n("ul",[n("li",[t._v("避免使用"),n("code",[t._v("table")]),t._v("布局")]),t._v(" "),n("li",[t._v("避免设置多层内联样式")]),t._v(" "),n("li",[t._v("避免频繁修改样式，最好一次性重写style属性，将样式列表定义为class，一次性修改class属性")]),t._v(" "),n("li",[t._v("尽可能在DOM树的最末端（树的叶子）修改改变class")]),t._v(" "),n("li",[t._v("避免使用CSS表达式（calc）")]),t._v(" "),n("li",[t._v("有动画的元素将其脱离文档流（"),n("code",[t._v("positioin: absolute|fixed")]),t._v("），这样修改样式只引起重绘，不会造成回流")]),t._v(" "),n("li",[t._v("transform代替top")]),t._v(" "),n("li",[t._v("CSS3硬件加速（GPU加速）")])]),t._v(" "),n("h4",{attrs:{id:"_2-使用documentfragment"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用documentfragment"}},[t._v("#")]),t._v(" 2.使用DocumentFragment")]),t._v(" "),n("p",[t._v("也算是1.")]),t._v(" "),n("blockquote",[n("p",[t._v("DocumentFragment是一个轻量级的文档对象，它是Document接口的一个子接口。它表示一个没有父节点的文档片段。\n在DOM中，通常需要对文档进行修改和操作，而这些操作可能涉及到多个节点的插入、删除或替换。如果直接在文档中进行这些操作，会导致多次重排和重绘，性能会受到影响。DocumentFragment的作用就是为了解决这个问题。\n可以看作是一个虚拟的容器，类似于一个临时的文档片段。你可以在DocumentFragment中创建和操作节点，然后将整个DocumentFragment一次性地插入到文档中，从而减少了对文档的多次操作。")])]),t._v(" "),n("p",[t._v("多次触发（回流or重绘） => 只触发一次")]),t._v(" "),n("p",[t._v("官方示例：")]),t._v(" "),n("div",{staticClass:"language-javascript extra-class"},[n("pre",{pre:!0,attrs:{class:"language-javascript"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" list "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("querySelector")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#list'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fruits "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Apple'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Orange'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Banana'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Melon'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fragment "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DocumentFragment")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nfruits"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("fruit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" li "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" document"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  li"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("textContent "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fruit\n  fragment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("li"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nlist"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("appendChild")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fragment"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),n("h3",{attrs:{id:"三、内存维度-运行时"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#三、内存维度-运行时"}},[t._v("#")]),t._v(" 三、内存维度（运行时）")]),t._v(" "),n("ul",[n("li",[n("RouterLink",{attrs:{to:"/interview/长列表优化.html"}},[t._v("长列表优化")]),t._v("，分时渲染，虚拟列表")],1),t._v(" "),n("li",[t._v("计算密集型任务使用"),n("code",[t._v("Web Worker")]),t._v("。")])]),t._v(" "),n("blockquote",[n("p",[t._v("Web Worker是一种在Web应用程序中使用的浏览器特性，它允许在后台线程中执行JavaScript代码，而不会阻塞主线程的执行。主线程通常用于处理用户交互和更新界面，而Web Worker可以用于执行一些计算密集型或耗时的任务，以避免影响用户体验。\nWeb Worker的工作原理是将JavaScript代码运行在独立的线程中，这个线程与主线程相互独立，彼此之间不会阻塞。这样，可以同时执行多个任务，提高应用程序的性能和响应速度。")])]),t._v(" "),n("h3",{attrs:{id:"参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.cn/post/7188894691356573754",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端性能优化|掘金"),n("OutboundLink")],1)]),t._v(" "),n("p",[n("a",{attrs:{href:"https://alienzhou.github.io/fe-performance-journey/",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端性能优化之旅"),n("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);